---
title: "PRD: JS i18n Language Server"
type: "Product Requirements Document"
version: "v1.0"
created_date: "2025-06-02"
last_updated: "2025-06-02"
status: "accepted"
---

# JS i18n Language Server

---

## エグゼクティブサマリー

### プロダクト概要

JavaScriptプロジェクトにおける国際化（i18n）開発を支援するLanguage Server Protocol (LSP) サーバー。
翻訳キーの自動補完、検証、リファクタリング機能により、多言語対応アプリケーションの開発効率を大幅に向上させる。

### ビジネス価値

- **主要目標:** i18n関連の開発時間を50%削減
- **期待効果:** 翻訳ミスの削減、開発者満足度向上
- **戦略的意義:** 多言語対応プロジェクトにおける開発体験の革新

### 成功指標（KPI）

| 指標               | 現在値 | 目標値 | 測定方法            | 達成期限  |
| ------------------ | ------ | ------ | ------------------- | --------- |
| 補完レスポンス時間 | -      | <100ms | LSPクライアントログ | MVP完成時 |

---

## 1. 背景・コンテキスト

### 1.1 現状分析

**開発現場の課題:**

- i18n対応プロジェクトで翻訳キーを手動管理している
- 翻訳キーの入力ミスが頻繁に発生
- 翻訳ファイルとコードの不整合が検出困難

**解決すべき課題:**

- **課題1:** 翻訳キーの手動入力による生産性低下（平均5-10分/時間のロス）
- **課題2:** 存在しない翻訳キーの参照によるランタイムエラー
- **課題3:** 未使用の翻訳キーの蓄積によるメンテナンス性の悪化

### 1.2 戦略的位置づけ

**オープンソース戦略:**
高品質なi18n LSPサーバーを提供し、JavaScript開発者コミュニティに貢献

---

## 2. ターゲットユーザー

#### ペルソナ: フロントエンド開発者

- **属性:** 中級以上のJavaScript開発者、VSCode/Neovim使用
- **現在の行動:** 翻訳キーを手動でコピー＆ペースト
- **課題・ニーズ:** 翻訳キーの自動補完、タイポ防止
- **目標:** 効率的な多言語対応開発
- **利用コンテキスト:** 日常的なコーディング作業中

---

## 3. ユーザーストーリー・ユースケース

### 3.1 コアユーザーストーリー

#### ストーリー1: 翻訳キーの自動補完

**As a** フロントエンド開発者  
**I want** 翻訳キーを入力時に自動補完候補を表示  
**So that** タイポなく文言を確認しながら効率的に翻訳キーを入力できる

**受け入れ基準:**

- [ ] 既存の翻訳キーが補完候補として表示される
- [ ] ネストされたキーも正しく補完される（例: `user.profile.name`）
- [ ] 100ms以内にレスポンスが返る

#### ストーリー2: 翻訳キーの検証

**As a** フロントエンド開発者  
**I want** 存在しない翻訳キーを使用時に警告表示  
**So that** ランタイムエラーを事前に防げる

**受け入れ基準:**

- [ ] 存在しない翻訳キーに対して診断メッセージが表示される
- [ ] 翻訳ファイルが更新されたらリアルタイムで検証が更新される
- [ ] 複数の言語ファイル間の不整合も検出される

#### ストーリー3: バーチャルテキスト表示

**As a** フロントエンド開発者  
**I want** 翻訳キーの実際の翻訳内容をインラインで確認  
**So that** 翻訳ファイルを開かずに内容を確認できる

**受け入れ基準:**

（エディタ側のプラグインとの統合が必要）

- [ ] デフォルト言語の翻訳がバーチャルテキストとして表示される
- [ ] 表示言語を切り替えられる
- [ ] 長いテキストは適切に省略される

---

## 4. 機能要件

### 4.1 必須機能（Must Have）

- **自動補完（Completion）**

  - 翻訳ファイル（JSON/YAML）から翻訳キーを抽出
  - ドット記法によるネストキーのサポート
  - 部分一致による補完候補のフィルタリング

- **診断（Diagnostics）**

  - 存在しない翻訳キーの検出
  - 未使用の翻訳キーの検出 (推奨)
  - 言語間の翻訳漏れ検出

- **ホバー情報（Hover）**

  - 翻訳キーにホバー時、全言語の翻訳を表示
  - マークダウン形式でのフォーマット
  - プレースホルダー情報の表示

- **定義ジャンプ（Go to Definition）**

  - 翻訳キーから翻訳ファイルの該当箇所へジャンプ
  - 複数の翻訳ファイルがある場合の選択UI

- **コードアクション（Code Actions）**

  - 存在しない翻訳キーの自動生成
  - 翻訳ファイルへの新規キー追加

- **バーチャルテキスト（Virtual Text / Inlay Hints）**

  - 翻訳キーの実際の値をインライン表示
  - 表示言語の切り替え機能

- **検索（Find References）**

  - 翻訳キーの使用箇所を検索
  - 結果をリスト表示し、該当箇所へジャンプ

- **主要なi18nライブラリのサポート**

  - react-i18next、vue-i18n、i18nextなどの主要ライブラリに対応
  - namespace や `.` によるネストされたキーのサポート
  - i18next の context や plurals のサポート

### 4.2 推奨機能（Should Have）

- **リファクタリング:** 翻訳キーの一括リネーム

### 4.3 機能外（Won't Have）

- 機械翻訳の統合（将来バージョンで検討）
- 翻訳管理システムとの連携

---

## 5. 非機能要件

### 5.1 パフォーマンス要件

| 項目               | 目標値 | 測定方法             | 優先度 |
| ------------------ | ------ | -------------------- | ------ |
| 補完レスポンス時間 | <100ms | LSPクライアントログ  | P0     |
| 初期化時間         | <3秒   | 1000キープロジェクト | P0     |
| メモリ使用量       | <50MB  | プロファイラー       | P1     |

### 5.2 互換性要件

- **エディタ対応:** VSCode、Neovim、その他LSP対応エディタ
- **言語対応:** JavaScript、TypeScript、JSX、TSX
- **翻訳ファイル形式:** JSON、YAML

### 5.3 品質要件

- **テストカバレッジ:** 80%以上
- **ドキュメント:** 完全なAPI仕様書とセットアップガイド

---

## 6. 技術仕様

### 6.1 技術スタック

- **言語:** Rust
- **フレームワーク:** tower-lsp
- **非同期ランタイム:** tokio
- **パーサー:** tree-sitter

### 6.2 対応i18nライブラリ

- i18next/react-i18next/next-i18next
- next-intl
- その他の一般的なi18nライブラリ

---

## 7. リリース計画

### 7.1 MVP

**スコープ:**

- 基本的な自動補完機能
- シンプルな診断機能
- Neovimでの動作確認

### 7.2 v1.0

**スコープ:**

- 全コア機能の実装
- マルチエディタ対応
- 包括的なドキュメント

---

## 8. 成功測定

**測定方法:**

- GitHubスター数
- cargoダウンロード数
- ユーザーフィードバック
- パフォーマンスベンチマーク

---

## 付録

### A. 参考資料

- [Language Server Protocol Specification](https://microsoft.github.io/language-server-protocol/)
- [tower-lsp Documentation](https://github.com/tower-lsp/tower-lsp)

### B. 変更履歴

| バージョン | 日付       | 変更内容 | 変更者     |
| ---------- | ---------- | -------- | ---------- |
| v1.0       | 2025-06-02 | 初版作成 | @nabekou29 |
